<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#2563eb">
  <meta name="description" content="å°ˆç‚ºå¤–ç±çœ‹è­·è¨­è¨ˆçš„å¤šèªè¨€åŸ¹è¨“èˆ‡å·¥ä½œç®¡ç†ç³»çµ±">
  <link rel="manifest" href="./manifest.json">
  <link rel="apple-touch-icon" href="./images/icons/icon-192x192.png">
  <link rel="icon" type="image/png" sizes="192x192" href="./images/icons/icon-192x192.png">
  <title>å¤–ç±çœ‹è­·åŸ¹è¨“åŠ©æ‰‹ | Caregiver Training Assistant</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Noto Sans TC', 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      color: #1f2937;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      min-height: 100vh;
    }

    .header {
      background: white;
      padding: 1rem 1.5rem;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: sticky;
      top: 0;
      z-index: 200;
    }

    .header h1 { color: #2563eb; font-size: 1.4rem; }

    .lang-select {
      padding: 0.4rem 0.8rem;
      border: 2px solid #e5e7eb;
      border-radius: 8px;
      font-size: 0.85rem;
      background: white;
    }

    .tabs {
      display: flex;
      background: white;
      border-bottom: 2px solid #e5e7eb;
      position: sticky;
      top: 60px;
      z-index: 199;
    }

    .tab {
      flex: 1;
      padding: 0.85rem 0.5rem;
      border: none;
      background: transparent;
      cursor: pointer;
      text-align: center;
      font-size: 0.85rem;
      transition: all 0.2s;
      border-bottom: 3px solid transparent;
      color: #6b7280;
    }

    .tab.active {
      color: #2563eb;
      border-bottom-color: #2563eb;
      font-weight: 700;
      background: #f0f7ff;
    }

    .content { padding: 1.5rem; padding-bottom: 4rem; }

    .section { display: none; }
    .section.active { display: block; animation: fadeIn 0.3s ease; }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(8px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* ===== BUTTONS ===== */
    .btn {
      padding: 0.7rem 1.4rem;
      background: #2563eb;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 0.95rem;
      font-weight: 600;
      transition: all 0.2s;
    }
    .btn:hover { background: #1e40af; transform: translateY(-1px); }
    .btn:disabled { background: #9ca3af; cursor: not-allowed; transform: none; }
    .btn-gray { background: #6b7280; }
    .btn-gray:hover { background: #4b5563; }
    .btn-green { background: #10b981; }
    .btn-green:hover { background: #059669; }

    /* ===== SCHEDULE ===== */
    .period-section {
      background: #f9fafb;
      border-radius: 12px;
      padding: 1.25rem;
      margin-bottom: 1rem;
      border: 2px solid #e5e7eb;
    }
    .period-title {
      color: #2563eb;
      font-size: 1.1rem;
      font-weight: 700;
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    .task-item {
      background: white;
      padding: 0.9rem 1rem;
      margin: 0.5rem 0;
      border-radius: 8px;
      display: flex;
      gap: 0.75rem;
      align-items: center;
      border: 2px solid #e5e7eb;
      transition: all 0.2s;
    }
    .task-item:hover { border-color: #93c5fd; }
    .task-item input[type="checkbox"] { width: 18px; height: 18px; cursor: pointer; }
    .task-name {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 0.2rem;
    }
    .task-zh {
      font-size: 0.95rem;
      font-weight: 600;
      color: #1f2937;
    }
    .task-id {
      font-size: 0.8rem;
      color: #2563eb;
      font-style: italic;
    }
    .task-time { color: #6b7280; font-size: 0.85rem; font-weight: 600; white-space: nowrap; }
    .task-delete {
      background: none;
      border: none;
      color: #d1d5db;
      font-size: 1.1rem;
      cursor: pointer;
      padding: 0.2rem 0.4rem;
      border-radius: 6px;
      transition: all 0.2s;
      flex-shrink: 0;
    }
    .task-delete:hover { color: #ef4444; background: #fef2f2; }
    .pending-translate {
      color: #f59e0b !important;
      animation: blink 1s infinite;
    }
    @keyframes blink { 0%,100%{ opacity:1 } 50%{ opacity:0.4 } }

    /* ===== TRANSLATE ===== */
    .translate-box {
      background: #f9fafb;
      border-radius: 12px;
      padding: 1.25rem;
      margin: 0.75rem 0;
      border: 2px solid #e5e7eb;
    }
    .translate-box label { display: block; font-weight: 600; margin-bottom: 0.5rem; }
    select {
      width: 100%;
      padding: 0.65rem;
      border: 2px solid #e5e7eb;
      border-radius: 8px;
      font-size: 0.95rem;
      background: white;
      margin-bottom: 0.75rem;
    }
    textarea {
      width: 100%;
      padding: 0.9rem;
      border: 2px solid #e5e7eb;
      border-radius: 8px;
      font-size: 1rem;
      font-family: inherit;
      resize: vertical;
      min-height: 110px;
    }
    textarea:focus, select:focus { outline: none; border-color: #2563eb; }
    textarea[readonly] { background: #f9fafb; }
    .phrase-btn {
      width: 100%;
      margin: 0.4rem 0;
      padding: 0.9rem 1rem;
      background: white;
      border: 2px solid #e5e7eb;
      border-radius: 8px;
      cursor: pointer;
      text-align: left;
      transition: all 0.2s;
    }
    .phrase-btn:hover { border-color: #2563eb; background: #eff6ff; transform: translateX(4px); }

    /* ===== TRAINING GRID ===== */
    .training-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
      gap: 1rem;
      margin-top: 1rem;
    }

    .training-card {
      background: white;
      border: 2px solid #e5e7eb;
      border-radius: 14px;
      padding: 1.25rem 0.75rem;
      cursor: pointer;
      transition: all 0.2s;
      text-align: center;
      position: relative;
    }
    .training-card:hover {
      border-color: #2563eb;
      transform: translateY(-4px);
      box-shadow: 0 8px 20px rgba(37,99,235,0.15);
    }
    .training-card.completed {
      border-color: #10b981;
      background: #f0fdf4;
    }
    .training-card .card-icon { font-size: 3rem; margin-bottom: 0.75rem; }
    .training-card h3 { font-size: 0.95rem; font-weight: 700; margin-bottom: 0.25rem; color: #1f2937; }
    .training-card p { font-size: 0.75rem; color: #6b7280; }
    .completed-badge {
      position: absolute;
      top: 8px;
      right: 8px;
      background: #10b981;
      color: white;
      border-radius: 50%;
      width: 22px;
      height: 22px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.75rem;
      display: none;
    }
    .training-card.completed .completed-badge { display: flex; }

    /* ===== MODAL ===== */
    .modal-overlay {
      display: none;
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,0.6);
      z-index: 1000;
      animation: fadeIn 0.2s;
    }
    .modal-overlay.open { display: flex; align-items: flex-end; }

    @media (min-width: 768px) {
      .modal-overlay.open { align-items: center; justify-content: center; }
    }

    .modal {
      background: white;
      width: 100%;
      max-width: 680px;
      max-height: 90vh;
      border-radius: 20px 20px 0 0;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      animation: slideUp 0.3s ease;
    }

    @media (min-width: 768px) {
      .modal { border-radius: 20px; }
    }

    @keyframes slideUp {
      from { transform: translateY(100%); }
      to { transform: translateY(0); }
    }

    .modal-header {
      padding: 1.25rem 1.5rem;
      background: linear-gradient(135deg, #2563eb, #7c3aed);
      color: white;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-shrink: 0;
    }
    .modal-header h2 { font-size: 1.25rem; }
    .modal-close {
      background: rgba(255,255,255,0.2);
      border: none;
      color: white;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      cursor: pointer;
      font-size: 1.2rem;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.2s;
    }
    .modal-close:hover { background: rgba(255,255,255,0.35); }

    .modal-body {
      overflow-y: auto;
      padding: 1.5rem;
      flex: 1;
    }

    .modal-footer {
      padding: 1rem 1.5rem;
      border-top: 2px solid #e5e7eb;
      display: flex;
      gap: 0.75rem;
      justify-content: flex-end;
      flex-shrink: 0;
    }

    /* ===== TRAINING CONTENT ===== */
    .lesson-intro {
      background: #eff6ff;
      border-left: 4px solid #2563eb;
      border-radius: 0 8px 8px 0;
      padding: 1rem;
      margin-bottom: 1.5rem;
      font-size: 0.95rem;
      color: #1e3a8a;
    }

    .step-list { display: flex; flex-direction: column; gap: 1rem; }

    .step-item {
      display: flex;
      gap: 1rem;
      align-items: flex-start;
      background: #f9fafb;
      border-radius: 10px;
      padding: 1rem;
      border: 2px solid #e5e7eb;
      transition: all 0.2s;
      cursor: pointer;
    }
    .step-item.done {
      background: #f0fdf4;
      border-color: #10b981;
    }
    .step-item.done .step-text { text-decoration: line-through; color: #6b7280; }

    .step-number {
      background: #2563eb;
      color: white;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      font-size: 0.9rem;
      flex-shrink: 0;
      transition: background 0.2s;
    }
    .step-item.done .step-number { background: #10b981; }

    .step-content { flex: 1; }
    .step-text { font-weight: 600; color: #1f2937; margin-bottom: 0.25rem; }
    .step-sub { font-size: 0.875rem; color: #6b7280; font-style: italic; }

    .bilingual-tag {
      display: inline-block;
      background: #dbeafe;
      color: #1e40af;
      font-size: 0.75rem;
      padding: 0.2rem 0.5rem;
      border-radius: 4px;
      margin-top: 0.4rem;
      font-weight: 600;
    }

    .warning-box {
      background: #fef3c7;
      border: 2px solid #f59e0b;
      border-radius: 8px;
      padding: 0.9rem 1rem;
      margin: 1rem 0;
      display: flex;
      gap: 0.75rem;
      align-items: flex-start;
      font-size: 0.9rem;
      color: #92400e;
    }

    .tip-box {
      background: #d1fae5;
      border: 2px solid #10b981;
      border-radius: 8px;
      padding: 0.9rem 1rem;
      margin: 1rem 0;
      display: flex;
      gap: 0.75rem;
      align-items: flex-start;
      font-size: 0.9rem;
      color: #065f46;
    }

    .progress-bar-wrap {
      background: #e5e7eb;
      border-radius: 999px;
      height: 8px;
      margin: 0.5rem 0 1.5rem;
      overflow: hidden;
    }
    .progress-bar {
      background: linear-gradient(90deg, #2563eb, #7c3aed);
      height: 100%;
      border-radius: 999px;
      transition: width 0.4s ease;
    }

    .section-divider {
      border: none;
      border-top: 2px dashed #e5e7eb;
      margin: 1.25rem 0;
    }

    .vocab-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 0.6rem;
      margin-top: 0.75rem;
    }
    .vocab-item {
      background: white;
      border: 2px solid #e5e7eb;
      border-radius: 8px;
      padding: 0.65rem 0.75rem;
    }
    .vocab-zh { font-weight: 700; font-size: 0.9rem; color: #1f2937; }
    .vocab-id { font-size: 0.8rem; color: #2563eb; margin-top: 0.1rem; }

    /* ===== EMERGENCY ===== */
    .emergency-banner {
      background: #fef2f2;
      border: 2px solid #ef4444;
      border-radius: 12px;
      padding: 1.25rem;
      margin-bottom: 1.5rem;
      display: flex;
      gap: 1rem;
      align-items: center;
      color: #991b1b;
      font-weight: 700;
    }
    .emergency-card {
      background: #f9fafb;
      border-radius: 12px;
      padding: 1.25rem;
      margin: 1rem 0;
      border: 2px solid #e5e7eb;
    }
    .emergency-title {
      color: #ef4444;
      font-size: 1.15rem;
      font-weight: 700;
      margin-bottom: 1rem;
    }
    .emergency-steps { padding-left: 1.5rem; }
    .emergency-steps li { margin-bottom: 0.6rem; line-height: 1.6; }

    /* ===== ALERTS ===== */
    .alert { padding: 1rem; border-radius: 8px; margin: 1rem 0; border-left: 4px solid; display: flex; gap: 0.75rem; }
    .alert-blue { background: #eff6ff; border-color: #2563eb; color: #1e3a8a; }
    .alert-yellow { background: #fef3c7; border-color: #f59e0b; color: #92400e; }
    .alert-green { background: #d1fae5; border-color: #10b981; color: #065f46; }

    /* ===== PROGRESS OVERVIEW ===== */
    .progress-overview {
      background: linear-gradient(135deg, #2563eb, #7c3aed);
      border-radius: 12px;
      padding: 1.25rem;
      color: white;
      margin-bottom: 1.5rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .progress-overview h3 { font-size: 1rem; margin-bottom: 0.25rem; opacity: 0.9; }
    .progress-count { font-size: 2rem; font-weight: 800; }

    @media (max-width: 768px) {
      .training-grid { grid-template-columns: repeat(2, 1fr); }
      .vocab-grid { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
<div class="container">
  <!-- Header -->
  <header class="header">
    <h1>ğŸ‘¨â€âš•ï¸ çœ‹è­·åŠ©æ‰‹</h1>
    <select id="lang-select" class="lang-select">
      <option value="zh-TW">ğŸ‡¹ğŸ‡¼ ç¹é«”ä¸­æ–‡</option>
      <option value="id" selected>ğŸ‡®ğŸ‡© Bahasa Indonesia</option>
      <option value="vi">ğŸ‡»ğŸ‡³ Tiáº¿ng Viá»‡t</option>
      <option value="th">ğŸ‡¹ğŸ‡­ à¸ à¸²à¸©à¸²à¹„à¸—à¸¢</option>
      <option value="tl">ğŸ‡µğŸ‡­ Filipino</option>
      <option value="en">ğŸ‡¬ğŸ‡§ English</option>
    </select>
  </header>

  <!-- Tabs -->
  <nav class="tabs">
    <button class="tab active" onclick="showTab('schedule',this)">ğŸ“… å·¥ä½œæ’ç¨‹</button>
    <button class="tab" onclick="showTab('translate',this)">ğŸŒ å³æ™‚ç¿»è­¯</button>
    <button class="tab" onclick="showTab('training',this)">ğŸ“š åŸ¹è¨“èª²ç¨‹</button>
    <button class="tab" onclick="showTab('emergency',this)">ğŸš¨ ç·Šæ€¥è™•ç†</button>
  </nav>

  <main class="content">

    <!-- ========== å·¥ä½œæ’ç¨‹ ========== -->
    <section id="schedule" class="section active">
      <h2 style="margin-bottom:1.5rem">æ¯æ—¥å·¥ä½œæ’ç¨‹ Daily Schedule</h2>

      <div class="period-section">
        <div class="period-title">ğŸŒ… æ—©ä¸Š Pagi <span style="font-size:0.85rem;font-weight:400;color:#6b7280">(06:00â€“12:00)</span></div>
        <div id="morning-tasks">
          <div class="task-item"><input type="checkbox" onchange="toggleTask(this)"><span class="task-name"><span class="task-zh">å”åŠ©èµ·åºŠèˆ‡ç›¥æ´—</span><span class="task-id">Bantu bangun tidur dan cuci muka</span></span><span class="task-time">07:00</span><button class="task-delete" onclick="deleteTask(this)" title="åˆªé™¤">âœ•</button></div>
          <div class="task-item"><input type="checkbox" onchange="toggleTask(this)"><span class="task-name"><span class="task-zh">æº–å‚™æ—©é¤èˆ‡é¤µé£Ÿ</span><span class="task-id">Siapkan sarapan dan bantu makan</span></span><span class="task-time">08:00</span><button class="task-delete" onclick="deleteTask(this)" title="åˆªé™¤">âœ•</button></div>
          <div class="task-item"><input type="checkbox" onchange="toggleTask(this)"><span class="task-name"><span class="task-zh">æ¸¬é‡ç”Ÿç†æŒ‡æ¨™ï¼ˆè¡€å£“ã€è¡€ç³–ï¼‰</span><span class="task-id">Ukur tanda vital (tensi, gula darah)</span></span><span class="task-time">09:00</span><button class="task-delete" onclick="deleteTask(this)" title="åˆªé™¤">âœ•</button></div>
          <div class="task-item"><input type="checkbox" onchange="toggleTask(this)"><span class="task-name"><span class="task-zh">å”åŠ©æœè—¥</span><span class="task-id">Bantu minum obat</span></span><span class="task-time">10:00</span><button class="task-delete" onclick="deleteTask(this)" title="åˆªé™¤">âœ•</button></div>
        </div>
      </div>

      <div class="period-section">
        <div class="period-title">â˜€ï¸ ä¸‹åˆ Siang <span style="font-size:0.85rem;font-weight:400;color:#6b7280">(12:00â€“18:00)</span></div>
        <div id="afternoon-tasks">
          <div class="task-item"><input type="checkbox" onchange="toggleTask(this)"><span class="task-name"><span class="task-zh">æº–å‚™åˆé¤èˆ‡é¤µé£Ÿ</span><span class="task-id">Siapkan makan siang dan bantu makan</span></span><span class="task-time">12:00</span><button class="task-delete" onclick="deleteTask(this)" title="åˆªé™¤">âœ•</button></div>
          <div class="task-item"><input type="checkbox" onchange="toggleTask(this)"><span class="task-name"><span class="task-zh">å”åŠ©åˆä¼‘ï¼ˆç¿»èº«ï¼‰</span><span class="task-id">Bantu tidur siang (balik badan)</span></span><span class="task-time">14:00</span><button class="task-delete" onclick="deleteTask(this)" title="åˆªé™¤">âœ•</button></div>
          <div class="task-item"><input type="checkbox" onchange="toggleTask(this)"><span class="task-name"><span class="task-zh">ç°¡æ˜“å¾©å¥æ´»å‹•</span><span class="task-id">Latihan rehabilitasi ringan</span></span><span class="task-time">16:00</span><button class="task-delete" onclick="deleteTask(this)" title="åˆªé™¤">âœ•</button></div>
          <div class="task-item"><input type="checkbox" onchange="toggleTask(this)"><span class="task-name"><span class="task-zh">è£œå……æ°´åˆ†</span><span class="task-id">Berikan minum air</span></span><span class="task-time">17:00</span><button class="task-delete" onclick="deleteTask(this)" title="åˆªé™¤">âœ•</button></div>
        </div>
      </div>

      <div class="period-section">
        <div class="period-title">ğŸŒ™ æ™šä¸Š Malam <span style="font-size:0.85rem;font-weight:400;color:#6b7280">(18:00â€“06:00)</span></div>
        <div id="evening-tasks">
          <div class="task-item"><input type="checkbox" onchange="toggleTask(this)"><span class="task-name"><span class="task-zh">æº–å‚™æ™šé¤èˆ‡é¤µé£Ÿ</span><span class="task-id">Siapkan makan malam dan bantu makan</span></span><span class="task-time">18:00</span><button class="task-delete" onclick="deleteTask(this)" title="åˆªé™¤">âœ•</button></div>
          <div class="task-item"><input type="checkbox" onchange="toggleTask(this)"><span class="task-name"><span class="task-zh">å”åŠ©æœæ™šé–“è—¥ç‰©</span><span class="task-id">Bantu minum obat malam</span></span><span class="task-time">19:00</span><button class="task-delete" onclick="deleteTask(this)" title="åˆªé™¤">âœ•</button></div>
          <div class="task-item"><input type="checkbox" onchange="toggleTask(this)"><span class="task-name"><span class="task-zh">å”åŠ©æ´—æ¾¡</span><span class="task-id">Bantu mandi</span></span><span class="task-time">20:00</span><button class="task-delete" onclick="deleteTask(this)" title="åˆªé™¤">âœ•</button></div>
          <div class="task-item"><input type="checkbox" onchange="toggleTask(this)"><span class="task-name"><span class="task-zh">å°±å¯¢æº–å‚™ï¼ˆç¿»èº«ã€æ‹èƒŒï¼‰</span><span class="task-id">Persiapan tidur (balik badan, tepuk punggung)</span></span><span class="task-time">21:00</span><button class="task-delete" onclick="deleteTask(this)" title="åˆªé™¤">âœ•</button></div>
          <div class="task-item"><input type="checkbox" onchange="toggleTask(this)"><span class="task-name"><span class="task-zh">å¤œé–“å·¡è¦–ï¼ˆç¢ºèªå®‰å…¨ï¼‰</span><span class="task-id">Pemeriksaan malam (pastikan aman)</span></span><span class="task-time">23:00</span><button class="task-delete" onclick="deleteTask(this)" title="åˆªé™¤">âœ•</button></div>
        </div>
      </div>

      <button class="btn" onclick="addTask()">â• æ–°å¢å·¥ä½œ Add Task</button>
    </section>

    <!-- ========== å³æ™‚ç¿»è­¯ ========== -->
    <section id="translate" class="section">
      <h2 style="margin-bottom:1.25rem">å³æ™‚ç¿»è­¯ Real-time Translation</h2>

      <div class="translate-box">
        <label>ä¾†æºèªè¨€ Source</label>
        <select id="source-lang">
          <option value="zh-TW" selected>ç¹é«”ä¸­æ–‡</option>
          <option value="zh-CN">ç®€ä½“ä¸­æ–‡</option>
          <option value="id">Bahasa Indonesia</option>
          <option value="vi">Tiáº¿ng Viá»‡t</option>
          <option value="th">à¸ à¸²à¸©à¸²à¹„à¸—à¸¢</option>
          <option value="en">English</option>
        </select>
        <textarea id="source-text" placeholder="è¼¸å…¥æ–‡å­—... Type here..."></textarea>
      </div>

      <div style="text-align:center;font-size:2rem;margin:0.5rem 0">â¬‡ï¸</div>

      <div class="translate-box">
        <label>ç›®æ¨™èªè¨€ Target</label>
        <select id="target-lang">
          <option value="zh-TW">ç¹é«”ä¸­æ–‡</option>
          <option value="id" selected>Bahasa Indonesia</option>
          <option value="vi">Tiáº¿ng Viá»‡t</option>
          <option value="th">à¸ à¸²à¸©à¸²à¹„à¸—à¸¢</option>
          <option value="tl">Filipino</option>
          <option value="en">English</option>
        </select>
        <textarea id="target-text" placeholder="ç¿»è­¯çµæœ..." readonly></textarea>
      </div>

      <div style="display:flex;gap:0.75rem;margin-top:1rem;flex-wrap:wrap">
        <button class="btn" onclick="translateText()" id="translate-btn">ğŸ”„ ç¿»è­¯ Translate</button>
        <button class="btn btn-gray" onclick="clearText()">ğŸ—‘ï¸ æ¸…é™¤ Clear</button>
      </div>

      <h3 style="margin:2rem 0 0.75rem;color:#1f2937;font-size:1.1rem">å¸¸ç”¨èªå¥ Common Phrases</h3>

      <button class="phrase-btn" onclick="quickTranslate('æ‚¨å¥½','Halo')"><div style="font-weight:700">æ‚¨å¥½</div><div style="color:#6b7280;font-size:0.875rem">Halo</div></button>
      <button class="phrase-btn" onclick="quickTranslate('åƒè—¥æ™‚é–“åˆ°äº†','Saatnya minum obat')"><div style="font-weight:700">åƒè—¥æ™‚é–“åˆ°äº†</div><div style="color:#6b7280;font-size:0.875rem">Saatnya minum obat</div></button>
      <button class="phrase-btn" onclick="quickTranslate('éœ€è¦å¹«å¿™å—ï¼Ÿ','Apakah Anda butuh bantuan?')"><div style="font-weight:700">éœ€è¦å¹«å¿™å—ï¼Ÿ</div><div style="color:#6b7280;font-size:0.875rem">Apakah Anda butuh bantuan?</div></button>
      <button class="phrase-btn" onclick="quickTranslate('æˆ‘å€‘å»æ•£æ­¥','Mari kita jalan-jalan')"><div style="font-weight:700">æˆ‘å€‘å»æ•£æ­¥</div><div style="color:#6b7280;font-size:0.875rem">Mari kita jalan-jalan</div></button>
      <button class="phrase-btn" onclick="quickTranslate('è«‹å–æ°´','Silakan minum air')"><div style="font-weight:700">è«‹å–æ°´</div><div style="color:#6b7280;font-size:0.875rem">Silakan minum air</div></button>
      <button class="phrase-btn" onclick="quickTranslate('æ‚¨ä»Šå¤©æ„Ÿè¦ºå¦‚ä½•ï¼Ÿ','Bagaimana perasaan Anda hari ini?')"><div style="font-weight:700">æ‚¨ä»Šå¤©æ„Ÿè¦ºå¦‚ä½•ï¼Ÿ</div><div style="color:#6b7280;font-size:0.875rem">Bagaimana perasaan Anda hari ini?</div></button>
      <button class="phrase-btn" onclick="quickTranslate('è«‹ç¿»èº«','Tolong balik badan')"><div style="font-weight:700">è«‹ç¿»èº«</div><div style="color:#6b7280;font-size:0.875rem">Tolong balik badan</div></button>
      <button class="phrase-btn" onclick="quickTranslate('ç¾åœ¨è¦æ›å°¿å¸ƒ','Sekarang ganti popok')"><div style="font-weight:700">ç¾åœ¨è¦æ›å°¿å¸ƒ</div><div style="color:#6b7280;font-size:0.875rem">Sekarang ganti popok</div></button>

      <div id="api-status" class="alert alert-yellow" style="margin-top:1.5rem">
        <span style="font-size:1.25rem">ğŸ’¡</span>
        <span id="status-text">ç­‰å¾…è¨­å®š...</span>
      </div>
    </section>

    <!-- ========== åŸ¹è¨“èª²ç¨‹ ========== -->
    <section id="training" class="section">
      <h2 style="margin-bottom:0.5rem">åŸ¹è¨“èª²ç¨‹ Training Courses</h2>
      <p style="color:#6b7280;margin-bottom:1.25rem;font-size:0.9rem">é»æ“Šèª²ç¨‹å¡ç‰‡é–‹å§‹å­¸ç¿’ / Klik kartu kursus untuk mulai belajar</p>

      <!-- Progress Overview -->
      <div class="progress-overview">
        <div>
          <h3>å­¸ç¿’é€²åº¦ Progress</h3>
          <div style="font-size:0.875rem;opacity:0.85">å®Œæˆèª²ç¨‹æ•¸ Completed courses</div>
        </div>
        <div style="text-align:right">
          <div class="progress-count"><span id="completed-count">0</span>/6</div>
          <div style="font-size:0.8rem;opacity:0.85">èª²ç¨‹ courses</div>
        </div>
      </div>
      <div class="progress-bar-wrap">
        <div class="progress-bar" id="overall-progress" style="width:0%"></div>
      </div>

      <div class="training-grid">
        <div class="training-card" id="card-hygiene" onclick="openLesson('hygiene')">
          <div class="completed-badge">âœ“</div>
          <div class="card-icon">ğŸš¿</div>
          <h3>å€‹äººè¡›ç”Ÿç…§è­·</h3>
          <p>Personal Hygiene</p>
        </div>
        <div class="training-card" id="card-meal" onclick="openLesson('meal')">
          <div class="completed-badge">âœ“</div>
          <div class="card-icon">ğŸš</div>
          <h3>é£²é£Ÿç…§è­·</h3>
          <p>Meal Care</p>
        </div>
        <div class="training-card" id="card-activity" onclick="openLesson('activity')">
          <div class="completed-badge">âœ“</div>
          <div class="card-icon">â™¿</div>
          <h3>æ´»å‹•è¼”åŠ©</h3>
          <p>Activity Assistance</p>
        </div>
        <div class="training-card" id="card-vital" onclick="openLesson('vital')">
          <div class="completed-badge">âœ“</div>
          <div class="card-icon">ğŸ©º</div>
          <h3>ç”Ÿç†ç›£æ¸¬</h3>
          <p>Vital Signs</p>
        </div>
        <div class="training-card" id="card-medication" onclick="openLesson('medication')">
          <div class="completed-badge">âœ“</div>
          <div class="card-icon">ğŸ’Š</div>
          <h3>ç”¨è—¥ç®¡ç†</h3>
          <p>Medication</p>
        </div>
        <div class="training-card" id="card-tube" onclick="openLesson('tube')">
          <div class="completed-badge">âœ“</div>
          <div class="card-icon">ğŸ¥</div>
          <h3>ç®¡è·¯ç…§é¡§</h3>
          <p>Tube Care</p>
        </div>
      </div>
    </section>

    <!-- ========== ç·Šæ€¥è™•ç† ========== -->
    <section id="emergency" class="section">
      <h2 style="margin-bottom:1.25rem">ç·Šæ€¥è™•ç†æŒ‡å— Emergency Guide</h2>

      <div class="emergency-banner">
        <span style="font-size:2.5rem">âš ï¸</span>
        <div>
          <div>ç·Šæ€¥æƒ…æ³è«‹ç«‹å³æ’¥æ‰“ 119 æˆ–è¯ç¹«å®¶å±¬ï¼</div>
          <div style="font-size:0.875rem;font-weight:400;margin-top:0.25rem">In case of emergency, call 119 or contact family!</div>
        </div>
      </div>

      <div class="emergency-card">
        <div class="emergency-title">ğŸ¤• è·Œå€’è™•ç† Fall Management</div>
        <ol class="emergency-steps">
          <li><strong>ä¿æŒå†·éœï¼Œä¸è¦ç§»å‹•ç—…æ‚£</strong><br><span style="color:#6b7280;font-size:0.875rem">Tetap tenang, jangan pindahkan pasien</span></li>
          <li><strong>å¤§è²å‘¼å«ç¢ºèªæ„è­˜</strong><br><span style="color:#6b7280;font-size:0.875rem">Panggil keras untuk cek kesadaran</span></li>
          <li><strong>æª¢æŸ¥æ˜¯å¦æœ‰å‡ºè¡€ï¼Œè¼•è¼•åŠ å£“</strong><br><span style="color:#6b7280;font-size:0.875rem">Periksa apakah ada perdarahan, tekan lembut</span></li>
          <li><strong>ç«‹å³æ’¥æ‰“ 119</strong><br><span style="color:#6b7280;font-size:0.875rem">Segera hubungi 119</span></li>
          <li><strong>è¨˜éŒ„è·Œå€’æ™‚é–“èˆ‡åœ°é»</strong><br><span style="color:#6b7280;font-size:0.875rem">Catat waktu dan lokasi jatuh</span></li>
          <li><strong>ç­‰å¾…æ•‘æ´ï¼Œä¿æŒé™ªä¼´</strong><br><span style="color:#6b7280;font-size:0.875rem">Tunggu bantuan, tetap temani pasien</span></li>
        </ol>
      </div>

      <div class="emergency-card">
        <div class="emergency-title">ğŸ˜® å—†å’³è™•ç† Choking Management</div>
        <ol class="emergency-steps">
          <li><strong>ç«‹å³åœæ­¢é€²é£Ÿ</strong><br><span style="color:#6b7280;font-size:0.875rem">Segera hentikan makan</span></li>
          <li><strong>è®“ç—…æ‚£èº«é«”å‰å‚¾ï¼Œé¼“å‹µç”¨åŠ›å’³å—½</strong><br><span style="color:#6b7280;font-size:0.875rem">Condongkan tubuh ke depan, dorong untuk batuk</span></li>
          <li><strong>ç”¨æ‰‹æŒæ‹æ‰“èƒŒéƒ¨ 5 æ¬¡</strong><br><span style="color:#6b7280;font-size:0.875rem">Tepuk punggung 5 kali dengan telapak tangan</span></li>
          <li><strong>è‹¥ç„¡æ•ˆï¼Œæ–½è¡Œå“ˆå§†ç«‹å…‹æ€¥æ•‘æ³•</strong><br><span style="color:#6b7280;font-size:0.875rem">Jika tidak berhasil, lakukan manuver Heimlich</span></li>
          <li><strong>ç«‹å³æ’¥æ‰“ 119</strong><br><span style="color:#6b7280;font-size:0.875rem">Segera hubungi 119</span></li>
        </ol>
      </div>

      <div class="emergency-card">
        <div class="emergency-title">ğŸ¬ ä½è¡€ç³–è™•ç† Low Blood Sugar</div>
        <ol class="emergency-steps">
          <li><strong>ç¢ºèªç—‡ç‹€ï¼šå†’æ±—ã€ç™¼æŠ–ã€è‡‰è‰²è’¼ç™½</strong><br><span style="color:#6b7280;font-size:0.875rem">Gejala: berkeringat, gemetar, pucat</span></li>
          <li><strong>ç«‹å³çµ¦äºˆå«ç³–é£²æ–™æˆ–ç³–æœ</strong><br><span style="color:#6b7280;font-size:0.875rem">Berikan minuman manis atau permen</span></li>
          <li><strong>è®“ç—…æ‚£åä¸‹ä¼‘æ¯</strong><br><span style="color:#6b7280;font-size:0.875rem">Dudukkan pasien dan istirahat</span></li>
          <li><strong>15 åˆ†é˜å¾Œæ¸¬é‡è¡€ç³–å€¼</strong><br><span style="color:#6b7280;font-size:0.875rem">Ukur gula darah setelah 15 menit</span></li>
          <li><strong>è‹¥ç„¡æ”¹å–„ï¼Œç«‹å³æ’¥æ‰“ 119</strong><br><span style="color:#6b7280;font-size:0.875rem">Jika tidak membaik, hubungi 119</span></li>
        </ol>
      </div>

      <div class="emergency-card">
        <div class="emergency-title">ğŸ’” å¿ƒè‚ºå¾©ç”¦è¡“ CPR</div>
        <div class="warning-box">
          <span>âš ï¸</span>
          <span>å…ˆæ’¥æ‰“ 119 å¾Œå†æ–½è¡Œ CPR / Hubungi 119 dulu sebelum CPR</span>
        </div>
        <ol class="emergency-steps">
          <li><strong>ç¢ºèªç’°å¢ƒå®‰å…¨ï¼Œè¼•æ‹é›™è‚©ç¢ºèªæ„è­˜</strong><br><span style="color:#6b7280;font-size:0.875rem">Pastikan lingkungan aman, tepuk bahu</span></li>
          <li><strong>å‘¼å«æ•‘æ´ï¼Œæ’¥æ‰“ 119</strong><br><span style="color:#6b7280;font-size:0.875rem">Panggil bantuan, hubungi 119</span></li>
          <li><strong>å°‡ç—…æ‚£å¹³èººï¼Œé€²è¡Œèƒ¸éƒ¨æŒ‰å£“ï¼ˆæ¯åˆ†é˜ 100-120 æ¬¡ï¼‰</strong><br><span style="color:#6b7280;font-size:0.875rem">Baringkan, lakukan kompresi dada 100-120x/menit</span></li>
          <li><strong>æ¯ 30 æ¬¡æŒ‰å£“å¾Œï¼Œé€²è¡Œ 2 æ¬¡äººå·¥å‘¼å¸</strong><br><span style="color:#6b7280;font-size:0.875rem">Setiap 30 kompresi, berikan 2 napas buatan</span></li>
          <li><strong>æŒçºŒè‡³æ•‘æ´åˆ°é”</strong><br><span style="color:#6b7280;font-size:0.875rem">Lanjutkan sampai bantuan tiba</span></li>
        </ol>
      </div>
    </section>

  </main>
</div>

<!-- ========== TRAINING MODAL ========== -->
<div class="modal-overlay" id="lesson-modal" onclick="closeModalOnOverlay(event)">
  <div class="modal">
    <div class="modal-header">
      <div>
        <div style="font-size:0.8rem;opacity:0.8;margin-bottom:0.2rem" id="modal-category">åŸ¹è¨“èª²ç¨‹</div>
        <h2 id="modal-title">èª²ç¨‹æ¨™é¡Œ</h2>
      </div>
      <button class="modal-close" onclick="closeLesson()">âœ•</button>
    </div>

    <div class="modal-body" id="modal-body">
      <!-- content injected by JS -->
    </div>

    <div class="modal-footer">
      <button class="btn btn-gray" onclick="closeLesson()">é—œé–‰ Close</button>
      <button class="btn btn-green" id="complete-btn" onclick="markComplete()">âœ… å®Œæˆèª²ç¨‹ Complete</button>
    </div>
  </div>
</div>

<script>
  // ===================== CONFIG =====================
  const GOOGLE_TRANSLATE_API_KEY = 'YOUR_API_KEY_HERE';

  // ===================== LESSON DATA =====================
  const lessons = {
    hygiene: {
      title: 'å€‹äººè¡›ç”Ÿç…§è­· Personal Hygiene',
      category: 'åŸºç¤ç…§è­· Basic Care',
      intro: 'è‰¯å¥½çš„å€‹äººè¡›ç”Ÿç…§è­·èƒ½ç¶­è­·é•·è€…çš„å°Šåš´èˆ‡å¥åº·ï¼Œé é˜²æ„ŸæŸ“èˆ‡å£“ç˜¡ã€‚\nPerawatan kebersihan yang baik menjaga martabat dan kesehatan lansia.',
      steps: [
        { zh: 'æ¯å¤©æ—©æ™¨å”åŠ©é•·è€…æ´—è‡‰ã€åˆ·ç‰™', id: 'Bantu lansia cuci muka dan gosok gigi setiap pagi', note: 'ä½¿ç”¨æº«æ°´ / Gunakan air hangat' },
        { zh: 'æ¯ 2â€“3 å¤©å”åŠ©æ²æµ´ï¼Œå¤å¤©å¯æ¯å¤©', id: 'Bantu mandi setiap 2-3 hari, musim panas bisa setiap hari', note: 'æ³¨æ„é˜²æ»‘å®‰å…¨ / Perhatikan keamanan anti-selip' },
        { zh: 'æ²æµ´å‰ç¢ºèªæ°´æº«ï¼ˆ36â€“38Â°C ç‚ºå®œï¼‰', id: 'Periksa suhu air sebelum mandi (36-38Â°C)', note: 'ç”¨æ‰‹è…•æ¸¬è©¦æ°´æº« / Tes suhu dengan pergelangan tangan' },
        { zh: 'å”åŠ©æ›´æ›ä¹¾æ·¨è¡£ç‰©ï¼Œæ³¨æ„ä¿æš–', id: 'Bantu ganti pakaian bersih, perhatikan kehangatan', note: '' },
        { zh: 'å®šæœŸä¿®å‰ªæŒ‡ç”²ï¼Œé¿å…æŒ‡ç”²éé•·', id: 'Potong kuku secara teratur', note: 'é£¯å¾ŒæŒ‡ç”²è¼ƒè»Ÿå®¹æ˜“å‰ª / Setelah makan kuku lebih lunak' },
        { zh: 'è§€å¯Ÿçš®è†šæ˜¯å¦æœ‰ç´…è…«ã€å£“ç˜¡', id: 'Perhatikan kulit apakah ada kemerahan atau luka tekan', note: 'ç‰¹åˆ¥æ³¨æ„éª¨çªå‡ºè™• / Perhatikan area tonjolan tulang' },
      ],
      warning: 'è‹¥é•·è€…æœ‰å‚·å£æˆ–ç‰¹æ®Šçš®è†šå•é¡Œï¼Œè«‹ç«‹å³å‘ŠçŸ¥å®¶å±¬æˆ–è­·ç†äººå“¡ã€‚\nJika ada luka atau masalah kulit khusus, segera beritahu keluarga.',
      tip: 'è®“é•·è€…å„˜é‡è‡ªå·±å®Œæˆèƒ½åšåˆ°çš„å‹•ä½œï¼Œç¶­è­·è‡ªä¸»æ€§ã€‚\nBiarkan lansia melakukan sendiri apa yang bisa, untuk menjaga kemandirian.',
      vocab: [
        { zh: 'æ´—è‡‰', id: 'cuci muka' }, { zh: 'åˆ·ç‰™', id: 'gosok gigi' },
        { zh: 'æ´—æ¾¡', id: 'mandi' }, { zh: 'æ›´è¡£', id: 'ganti pakaian' },
        { zh: 'å‰ªæŒ‡ç”²', id: 'potong kuku' }, { zh: 'çš®è†š', id: 'kulit' },
      ]
    },
    meal: {
      title: 'é£²é£Ÿç…§è­· Meal Care',
      category: 'åŸºç¤ç…§è­· Basic Care',
      intro: 'é©ç•¶çš„é£²é£Ÿç…§è­·èƒ½ç¢ºä¿é•·è€…ç²å¾—å……è¶³ç‡Ÿé¤Šï¼Œä¸¦é é˜²å—†å’³å±éšªã€‚\nPerawatan makan yang tepat memastikan nutrisi cukup dan mencegah tersedak.',
      steps: [
        { zh: 'é¤å‰å”åŠ©é•·è€…æ´—æ‰‹', id: 'Bantu lansia cuci tangan sebelum makan', note: '' },
        { zh: 'è®“é•·è€…åç›´æˆ–åŠåè‡¥ï¼ˆè‡³å°‘ 45 åº¦ï¼‰', id: 'Posisikan lansia duduk tegak atau semi-duduk (min 45 derajat)', note: 'é é˜²å—†å’³ / Mencegah tersedak' },
        { zh: 'é£Ÿç‰©åˆ‡å°å¡Šæˆ–æ‰“æˆæ³¥ç‹€ï¼ˆä¾éœ€è¦ï¼‰', id: 'Potong makanan kecil atau haluskan (sesuai kebutuhan)', note: '' },
        { zh: 'æ¯å£é£Ÿç‰©å°‘é‡ï¼Œè®“é•·è€…å……åˆ†å’€åš¼å¾Œå†é¤µä¸‹ä¸€å£', id: 'Setiap suap sedikit, biarkan kunyah dulu baru suap berikutnya', note: '' },
        { zh: 'é€²é£Ÿä¸­é¼“å‹µé©é‡é£²æ°´', id: 'Dorong minum air secukupnya saat makan', note: 'æ¯å¤©è‡³å°‘ 1500â€“2000ml / Minimal 1500-2000ml per hari' },
        { zh: 'è¨˜éŒ„æ¯é¤é€²é£Ÿé‡èˆ‡é£Ÿæ…¾ç‹€æ³', id: 'Catat jumlah makan dan nafsu makan setiap kali makan', note: '' },
        { zh: 'é¤å¾Œè®“é•·è€…ä¿æŒåå§¿ 30 åˆ†é˜', id: 'Setelah makan, biarkan duduk selama 30 menit', note: 'é˜²æ­¢é€†æµ / Mencegah refluks' },
      ],
      warning: 'è‹¥é•·è€…é€²é£Ÿæ™‚æŒçºŒå—†å’³ï¼Œæ‡‰åœæ­¢é€²é£Ÿä¸¦é€šçŸ¥è­·ç†äººå“¡ã€‚\nJika terus tersedak saat makan, hentikan dan beritahu perawat.',
      tip: 'æº«ç†±çš„é£Ÿç‰©æ¯”å†·é£Ÿæ›´å®¹æ˜“ååš¥ã€‚å¯é©ç•¶å¢åŠ é£Ÿç‰©é»ç¨ åº¦ã€‚\nMakanan hangat lebih mudah ditelan. Bisa tambahkan pengental jika perlu.',
      vocab: [
        { zh: 'åƒé£¯', id: 'makan' }, { zh: 'å–æ°´', id: 'minum air' },
        { zh: 'å—†å’³', id: 'tersedak' }, { zh: 'é£Ÿæ…¾', id: 'nafsu makan' },
        { zh: 'åˆ‡ç¢', id: 'cincang halus' }, { zh: 'æ”ªæ‹Œ', id: 'aduk' },
      ]
    },
    activity: {
      title: 'æ´»å‹•è¼”åŠ© Activity Assistance',
      category: 'ç§»å‹•ç…§è­· Mobility Care',
      intro: 'æ­£ç¢ºçš„ç§»ä½èˆ‡ç¿»èº«æŠ€å·§èƒ½ä¿è­·é•·è€…å®‰å…¨ï¼ŒåŒæ™‚ä¿è­·ç…§è­·è€…çš„è…°éƒ¨å¥åº·ã€‚\nTeknik pindah dan balik badan yang benar melindungi lansia dan punggung perawat.',
      steps: [
        { zh: 'æ¯ 2 å°æ™‚å”åŠ©è‡¥åºŠé•·è€…ç¿»èº«ä¸€æ¬¡', id: 'Bantu lansia berbaring balik badan setiap 2 jam', note: 'é é˜²å£“ç˜¡ / Mencegah luka tekan' },
        { zh: 'ç¿»èº«å‰å‘ŠçŸ¥é•·è€…ï¼Œé¿å…é©šåš‡', id: 'Beritahu lansia sebelum membalikkan badan', note: '' },
        { zh: 'ç§»ä½æ™‚å½æ›²è†è“‹ï¼Œé¿å…å½è…°æ¬é‡', id: 'Tekuk lutut saat memindahkan, jangan membungkuk', note: 'ä¿è­·è‡ªèº«è…°éƒ¨ / Lindungi punggung Anda' },
        { zh: 'å¾åºŠç§»è‡³è¼ªæ¤…ï¼šå…ˆå›ºå®šè¼ªæ¤…ç…è»Š', id: 'Dari tempat tidur ke kursi roda: kunci rem dulu', note: '' },
        { zh: 'å”åŠ©ç«™ç«‹æ™‚ï¼Œè®“é•·è€…å…ˆåç©©å†ç·©æ…¢ç«™èµ·', id: 'Saat bantu berdiri, duduk stabil dulu lalu pelan-pelan berdiri', note: '' },
        { zh: 'æ¯å¤©é€²è¡Œ 10â€“15 åˆ†é˜çš„ç°¡æ˜“è‚¢é«”é‹å‹•', id: 'Lakukan latihan ringan 10-15 menit setiap hari', note: 'ä¾é†«å¸«å»ºè­° / Sesuai anjuran dokter' },
      ],
      warning: 'ç§»ä½éç¨‹ä¸­è‹¥é•·è€…æ„Ÿåˆ°ç–¼ç—›æˆ–ä¸é©ï¼Œæ‡‰ç«‹å³åœæ­¢ã€‚\nJika lansia kesakitan saat dipindahkan, segera hentikan.',
      tip: 'ä½¿ç”¨ç§»ä½æ»‘æ¿æˆ–ç§»ä½è…°å¸¶å¯ä»¥æ›´å®‰å…¨åœ°å”åŠ©ç§»ä½ã€‚\nGunakan papan geser atau sabuk transfer untuk memindahkan dengan lebih aman.',
      vocab: [
        { zh: 'ç¿»èº«', id: 'balik badan' }, { zh: 'åèµ·ä¾†', id: 'duduk' },
        { zh: 'ç«™èµ·ä¾†', id: 'berdiri' }, { zh: 'è¼ªæ¤…', id: 'kursi roda' },
        { zh: 'æ‰¶è‘—', id: 'pegang' }, { zh: 'æ…¢æ…¢ä¾†', id: 'pelan-pelan' },
      ]
    },
    vital: {
      title: 'ç”Ÿç†ç›£æ¸¬ Vital Signs Monitoring',
      category: 'å¥åº·ç›£æ¸¬ Health Monitoring',
      intro: 'å®šæœŸç›£æ¸¬ç”Ÿç†æ•¸å€¼èƒ½æ—©æœŸç™¼ç¾ç•°å¸¸ï¼ŒåŠæ™‚è™•ç†ã€‚\nPemantauan tanda vital secara rutin membantu deteksi dini kelainan.',
      steps: [
        { zh: 'æ¯å¤©å›ºå®šæ™‚é–“æ¸¬é‡è¡€å£“ï¼ˆæ—©æ™šå„ä¸€æ¬¡ï¼‰', id: 'Ukur tekanan darah setiap hari pada waktu yang sama (pagi dan malam)', note: 'æ­£å¸¸å€¼ï¼š120/80 mmHg ä»¥ä¸‹' },
        { zh: 'æ¸¬è¡€å£“å‰è®“é•·è€…ä¼‘æ¯ 5 åˆ†é˜ï¼Œä¸èªªè©±', id: 'Istirahat 5 menit sebelum ukur tensi, jangan bicara', note: '' },
        { zh: 'ç³–å°¿ç—…é•·è€…æ¯å¤©æ¸¬è¡€ç³–ï¼ˆç©ºè…¹åŠé£¯å¾Œ 2 å°æ™‚ï¼‰', id: 'Lansia diabetes ukur gula darah setiap hari (puasa dan 2 jam setelah makan)', note: 'æ­£å¸¸ç©ºè…¹ï¼š70â€“100 mg/dL' },
        { zh: 'æ¯å¤©æ¸¬é‡é«”æº«', id: 'Ukur suhu tubuh setiap hari', note: 'æ­£å¸¸å€¼ï¼š36â€“37.5Â°C' },
        { zh: 'è§€å¯Ÿå‘¼å¸é »ç‡ï¼ˆæ­£å¸¸æ¯åˆ†é˜ 12â€“20 æ¬¡ï¼‰', id: 'Perhatikan frekuensi napas (normal 12-20 kali per menit)', note: '' },
        { zh: 'å°‡æ‰€æœ‰æ•¸å€¼è¨˜éŒ„åœ¨å¥åº·è¨˜éŒ„æœ¬', id: 'Catat semua angka di buku catatan kesehatan', note: 'æœ‰ç•°å¸¸ç«‹å³é€šçŸ¥å®¶å±¬' },
      ],
      warning: 'è¡€å£“è¶…é 140/90 æˆ–ä½æ–¼ 90/60ï¼›è¡€ç³–ä½æ–¼ 70 æˆ–é«˜æ–¼ 300ï¼Œæ‡‰ç«‹å³é€šçŸ¥å®¶å±¬ã€‚\nTensi >140/90 atau <90/60; gula darah <70 atau >300, segera beritahu keluarga.',
      tip: 'æ¸¬é‡æ™‚é–“å’Œå§¿å‹¢ä¿æŒä¸€è‡´ï¼Œæ•¸å€¼æ‰å…·æœ‰å¯æ¯”è¼ƒæ€§ã€‚\nWaktu dan posisi pengukuran harus konsisten agar angka bisa dibandingkan.',
      vocab: [
        { zh: 'è¡€å£“', id: 'tekanan darah' }, { zh: 'è¡€ç³–', id: 'gula darah' },
        { zh: 'é«”æº«', id: 'suhu tubuh' }, { zh: 'è„ˆæ', id: 'denyut nadi' },
        { zh: 'æ­£å¸¸', id: 'normal' }, { zh: 'ç•°å¸¸', id: 'tidak normal' },
      ]
    },
    medication: {
      title: 'ç”¨è—¥ç®¡ç† Medication Management',
      category: 'é†«ç™‚ç…§è­· Medical Care',
      intro: 'æ­£ç¢ºçš„ç”¨è—¥ç®¡ç†èƒ½ç¢ºä¿æ²»ç™‚æ•ˆæœï¼Œé¿å…è—¥ç‰©éŒ¯èª¤çš„å±å®³ã€‚\nManajemen obat yang benar memastikan efek pengobatan dan mencegah kesalahan.',
      steps: [
        { zh: 'ç¢ºèªã€Œäº”æ­£ç¢ºã€ï¼šæ­£ç¢ºç—…äººã€è—¥å“ã€åŠ‘é‡ã€æ™‚é–“ã€æ–¹å¼', id: 'Konfirmasi 5 benar: pasien, obat, dosis, waktu, cara pemberian', note: 'æ¯æ¬¡çµ¦è—¥å‰éƒ½è¦ç¢ºèª' },
        { zh: 'æŒ‰ç…§é†«å¸«æŒ‡ç¤ºçš„æ™‚é–“çµ¦è—¥ï¼Œä¸å¯è‡ªè¡Œèª¿æ•´', id: 'Berikan obat sesuai waktu yang ditentukan dokter, jangan ubah sendiri', note: '' },
        { zh: 'çµ¦è—¥å¾Œç¢ºèªé•·è€…å·²åä¸‹ï¼ˆå¼µå˜´ç¢ºèªï¼‰', id: 'Setelah memberi obat, pastikan sudah ditelan (cek buka mulut)', note: '' },
        { zh: 'è¨˜éŒ„æ¯æ¬¡çµ¦è—¥æ™‚é–“èˆ‡é•·è€…åæ‡‰', id: 'Catat waktu pemberian dan reaksi lansia setiap kali', note: '' },
        { zh: 'è—¥å“å­˜æ”¾åœ¨ä¹¾ç‡¥é™°æ¶¼è™•ï¼Œé é›¢å…’ç«¥', id: 'Simpan obat di tempat kering, sejuk, jauh dari anak-anak', note: '' },
        { zh: 'ç™¼ç¾é•·è€…ä¸é¡˜æœè—¥ï¼Œé€šçŸ¥å®¶å±¬ï¼Œä¸å¯å¼·è¿«', id: 'Jika lansia menolak minum obat, beritahu keluarga, jangan paksa', note: '' },
      ],
      warning: 'çµ•å°ä¸å¯è‡ªè¡Œå¢æ¸›è—¥é‡æˆ–çµ¦äºˆéé†«å¸«é–‹ç«‹çš„è—¥å“ã€‚\nJangan pernah menambah/mengurangi dosis atau memberi obat yang tidak diresepkan dokter.',
      tip: 'å¯ä½¿ç”¨æ¯æ—¥è—¥ç›’ï¼ˆpill organizerï¼‰å¹«åŠ©åˆ†é¡è—¥å“ã€‚\nGunakan kotak obat harian (pill organizer) untuk membantu mengatur obat.',
      vocab: [
        { zh: 'è—¥', id: 'obat' }, { zh: 'åŠ‘é‡', id: 'dosis' },
        { zh: 'é£¯å‰', id: 'sebelum makan' }, { zh: 'é£¯å¾Œ', id: 'setelah makan' },
        { zh: 'ç©ºè…¹', id: 'perut kosong' }, { zh: 'å‰¯ä½œç”¨', id: 'efek samping' },
      ]
    },
    tube: {
      title: 'ç®¡è·¯ç…§é¡§ Tube Care',
      category: 'å°ˆæ¥­ç…§è­· Advanced Care',
      intro: 'ç®¡è·¯ç…§é¡§éœ€è¦ç‰¹åˆ¥ç´°å¿ƒï¼Œä»»ä½•ç•°å¸¸æ‡‰ç«‹å³é€šçŸ¥è­·ç†äººå“¡ã€‚\nPerawatan selang membutuhkan kehati-hatian ekstra, laporkan kelainan segera.',
      steps: [
        { zh: 'æ¯æ¬¡é¤µé£Ÿå‰ç¢ºèªé¼»èƒƒç®¡ä½ç½®æ˜¯å¦æ­£ç¢º', id: 'Sebelum setiap pemberian makan, pastikan posisi NGT benar', note: 'å¯ç”¨æ³¨å°„å™¨å›æŠ½ç¢ºèª' },
        { zh: 'é¼»èƒƒç®¡æ¯å¤©ç”¨æ¸…æ°´æ¸…æ½”å›ºå®šçš„è† å¸ƒåŠé¼»å­”å‘¨åœ', id: 'Bersihkan plester dan sekitar hidung dengan air bersih setiap hari', note: '' },
        { zh: 'æ¯æ¬¡çŒé£Ÿå‰å¾Œä»¥ 30â€“50ml æº«é–‹æ°´æ²–æ´—ç®¡è·¯', id: 'Bilas selang dengan 30-50ml air hangat sebelum dan sesudah makan', note: 'é˜²æ­¢å µå¡ / Mencegah sumbatan' },
        { zh: 'æ°£åˆ‡ç—…æ‚£æ¯å¤©æ¸…æ½”æ°£åˆ‡å¥—ç®¡å‘¨åœçš®è†š', id: 'Bersihkan kulit sekitar trakeostomi setiap hari', note: '' },
        { zh: 'è§€å¯Ÿç®¡è·¯å›ºå®šæ˜¯å¦ç©©å®šï¼Œæœ‰ç„¡æ»²æ¼æˆ–ç•°å‘³', id: 'Perhatikan apakah selang stabil, ada kebocoran atau bau', note: '' },
        { zh: 'ç™¼ç¾ç•°å¸¸ï¼ˆæ»²æ¶²ã€å‡ºè¡€ã€å µå¡ï¼‰ç«‹å³é€šçŸ¥è­·ç†å¸«', id: 'Jika ada kelainan (bocor, berdarah, tersumbat), segera hubungi perawat', note: '' },
      ],
      warning: 'ç®¡è·¯ç…§é¡§å±¬æ–¼å°ˆæ¥­é†«ç™‚æ“ä½œï¼Œé¦–æ¬¡åŸ·è¡Œå‰å‹™å¿…ç”±è­·ç†äººå“¡å¯¦éš›ç¤ºç¯„æŒ‡å°ã€‚\nPerawatan selang adalah tindakan medis profesional, harus dipandu perawat terlebih dahulu.',
      tip: 'ä¿æŒç®¡è·¯è¨˜éŒ„ï¼ŒåŒ…æ‹¬çŒé£Ÿæ™‚é–“ã€é‡å’Œé•·è€…åæ‡‰ã€‚\nJaga catatan selang termasuk waktu pemberian, jumlah dan reaksi lansia.',
      vocab: [
        { zh: 'é¼»èƒƒç®¡', id: 'selang NGT' }, { zh: 'çŒé£Ÿ', id: 'pemberian makan via selang' },
        { zh: 'æ²–æ´—', id: 'bilas' }, { zh: 'å µå¡', id: 'tersumbat' },
        { zh: 'å›ºå®š', id: 'fiksasi' }, { zh: 'æ»²æ¼', id: 'bocor' },
      ]
    }
  };

  // ===================== STATE =====================
  let currentLesson = null;
  let completedLessons = new Set();
  let stepsDone = {};

  // ===================== TAB =====================
  function showTab(tabName, button) {
    document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
    document.getElementById(tabName).classList.add('active');
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
    button.classList.add('active');
    window.scrollTo({ top: 0, behavior: 'smooth' });
  }

  // ===================== SCHEDULE =====================
  function toggleTask(checkbox) {
    checkbox.parentElement.style.opacity = checkbox.checked ? '0.5' : '1';
  }

  function deleteTask(btn) {
    const item = btn.closest('.task-item');
    const name = item.querySelector('.task-zh')?.textContent || item.querySelector('.task-name')?.textContent || 'æ­¤å·¥ä½œ';
    if (confirm(`ç¢ºå®šåˆªé™¤ã€Œ${name}ã€ï¼Ÿ\nHapus tugas ini?`)) {
      item.style.transition = 'all 0.3s';
      item.style.opacity = '0';
      item.style.transform = 'translateX(20px)';
      setTimeout(() => item.remove(), 300);
    }
  }

  async function addTask() {
    const taskZh = prompt('è«‹è¼¸å…¥ä¸­æ–‡å·¥ä½œåç¨±ï¼š\nï¼ˆä¾‹å¦‚ï¼šå”åŠ©å¾©å¥ï¼‰');
    if (!taskZh) return;

    const time = prompt('è«‹è¼¸å…¥æ™‚é–“ï¼š\nï¼ˆä¾‹å¦‚ï¼š15:00ï¼‰');
    if (!time) return;

    const period = prompt('é¸æ“‡æ™‚æ®µ Pilih waktu:\n1 = æ—©ä¸Š Pagi\n2 = ä¸‹åˆ Siang\n3 = æ™šä¸Š Malam');
    const containers = { '1': 'morning-tasks', '2': 'afternoon-tasks', '3': 'evening-tasks' };
    const container = document.getElementById(containers[period]);
    if (!container) { alert('âŒ ç„¡æ•ˆçš„æ™‚æ®µ / Waktu tidak valid'); return; }

    // å…ˆæ–°å¢ä»»å‹™ï¼Œå°å°¼æ–‡é¡¯ç¤ºã€Œç¿»è­¯ä¸­...ã€
    const div = document.createElement('div');
    div.className = 'task-item';
    div.innerHTML = `
      <input type="checkbox" onchange="toggleTask(this)">
      <span class="task-name">
        <span class="task-zh">${taskZh}</span>
        <span class="task-id pending-translate">â³ è‡ªå‹•ç¿»è­¯ä¸­...</span>
      </span>
      <span class="task-time">${time}</span>
      <button class="task-delete" onclick="deleteTask(this)" title="åˆªé™¤">âœ•</button>`;
    container.appendChild(div);

    // æ»¾å‹•åˆ°æ–°ä»»å‹™
    div.scrollIntoView({ behavior: 'smooth', block: 'center' });

    // è‡ªå‹•ç¿»è­¯ä¸­æ–‡ â†’ å°å°¼æ–‡
    const idSpan = div.querySelector('.pending-translate');
    if (GOOGLE_TRANSLATE_API_KEY !== 'YOUR_API_KEY_HERE') {
      try {
        const res = await fetch(
          `https://translation.googleapis.com/language/translate/v2?key=${GOOGLE_TRANSLATE_API_KEY}`,
          {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ q: taskZh, source: 'zh-TW', target: 'id', format: 'text' })
          }
        );
        const data = await res.json();
        const translated = data.data.translations[0].translatedText;
        idSpan.textContent = translated;
        idSpan.classList.remove('pending-translate');
      } catch (e) {
        idSpan.textContent = 'ï¼ˆç¿»è­¯å¤±æ•—ï¼‰';
        idSpan.classList.remove('pending-translate');
      }
    } else {
      idSpan.textContent = 'ï¼ˆæœªè¨­å®š API Keyï¼‰';
      idSpan.classList.remove('pending-translate');
    }
  }

  // ===================== TRANSLATE =====================
  window.addEventListener('load', () => {
    const status = document.getElementById('status-text');
    const box = document.getElementById('api-status');
    if (GOOGLE_TRANSLATE_API_KEY === 'AIzaSyDcwz7AvpvjfEvRqPuXZ7s-uxKbbqhRa9I') {
      status.textContent = 'âŒ ç›®å‰ä½¿ç”¨é›¢ç·šæ¨¡å¼ï¼Œè«‹è¨­å®š Google Translation API Key';
    } else {
      status.textContent = 'âœ… API å·²è¨­å®šï¼Œå¯ä½¿ç”¨å³æ™‚ç¿»è­¯ï¼';
      box.className = 'alert alert-green';
    }
  });

  function quickTranslate(zh, id) {
    document.getElementById('source-text').value = zh;
    document.getElementById('target-text').value = id;
  }

  async function translateText() {
    const source = document.getElementById('source-text').value.trim();
    const sourceLang = document.getElementById('source-lang').value;
    const targetLang = document.getElementById('target-lang').value;
    const target = document.getElementById('target-text');
    const btn = document.getElementById('translate-btn');
    if (!source) { alert('âŒ è«‹è¼¸å…¥è¦ç¿»è­¯çš„æ–‡å­—'); return; }
    if (sourceLang === targetLang) { alert('âŒ ä¾†æºå’Œç›®æ¨™èªè¨€ä¸èƒ½ç›¸åŒ'); return; }
    if (GOOGLE_TRANSLATE_API_KEY === 'YOUR_API_KEY_HERE') {
      target.value = 'é›¢ç·šæ¨¡å¼ï¼šè«‹ä½¿ç”¨ä¸‹æ–¹çš„å¸¸ç”¨èªå¥æŒ‰éˆ•ï¼Œæˆ–è¨­å®š Google Translation API Key';
      return;
    }
    btn.disabled = true;
    btn.textContent = 'ç¿»è­¯ä¸­...';
    try {
      const res = await fetch(`https://translation.googleapis.com/language/translate/v2?key=${GOOGLE_TRANSLATE_API_KEY}`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ q: source, source: sourceLang, target: targetLang, format: 'text' })
      });
      const data = await res.json();
      target.value = data.data.translations[0].translatedText;
    } catch (e) {
      target.value = '';
      alert('âŒ ç¿»è­¯å¤±æ•—ï¼š' + e.message);
    } finally {
      btn.disabled = false;
      btn.textContent = 'ğŸ”„ ç¿»è­¯ Translate';
    }
  }

  function clearText() {
    document.getElementById('source-text').value = '';
    document.getElementById('target-text').value = '';
  }

  // ===================== TRAINING MODAL =====================
  function openLesson(key) {
    currentLesson = key;
    const lesson = lessons[key];
    if (!stepsDone[key]) stepsDone[key] = new Set();

    document.getElementById('modal-category').textContent = lesson.category;
    document.getElementById('modal-title').textContent = lesson.title;

    // Build body HTML
    let html = '';

    // Intro
    html += `<div class="lesson-intro">${lesson.intro.replace('\n', '<br>')}</div>`;

    // Progress
    const done = stepsDone[key].size;
    const total = lesson.steps.length;
    const pct = Math.round(done / total * 100);
    html += `<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:0.25rem">
      <span style="font-weight:700;color:#1f2937">æ­¥é©Ÿé€²åº¦ Steps</span>
      <span style="font-size:0.875rem;color:#6b7280">${done}/${total} (${pct}%)</span>
    </div>
    <div class="progress-bar-wrap"><div class="progress-bar" style="width:${pct}%"></div></div>`;

    // Steps
    html += `<div class="step-list">`;
    lesson.steps.forEach((step, i) => {
      const done = stepsDone[key] && stepsDone[key].has(i);
      html += `<div class="step-item ${done ? 'done' : ''}" onclick="toggleStep('${key}', ${i}, this)">
        <div class="step-number">${done ? 'âœ“' : i + 1}</div>
        <div class="step-content">
          <div class="step-text">${step.zh}</div>
          <div class="step-sub">${step.id}</div>
          ${step.note ? `<span class="bilingual-tag">ğŸ’¡ ${step.note}</span>` : ''}
        </div>
      </div>`;
    });
    html += `</div>`;

    // Warning
    if (lesson.warning) {
      html += `<div class="warning-box" style="margin-top:1.25rem"><span>âš ï¸</span><span>${lesson.warning.replace('\n', '<br>')}</span></div>`;
    }

    // Tip
    if (lesson.tip) {
      html += `<div class="tip-box"><span>ğŸ’š</span><span>${lesson.tip.replace('\n', '<br>')}</span></div>`;
    }

    // Vocabulary
    html += `<hr class="section-divider">
    <div style="font-weight:700;margin-bottom:0.5rem;color:#1f2937">ğŸ“– ç›¸é—œè©å½™ Vocabulary</div>
    <div class="vocab-grid">`;
    lesson.vocab.forEach(v => {
      html += `<div class="vocab-item"><div class="vocab-zh">${v.zh}</div><div class="vocab-id">${v.id}</div></div>`;
    });
    html += `</div>`;

    document.getElementById('modal-body').innerHTML = html;

    // Complete button state
    const completeBtn = document.getElementById('complete-btn');
    if (completedLessons.has(key)) {
      completeBtn.textContent = 'âœ… å·²å®Œæˆ Completed';
      completeBtn.style.background = '#6b7280';
    } else {
      completeBtn.textContent = 'âœ… å®Œæˆèª²ç¨‹ Complete';
      completeBtn.style.background = '#10b981';
    }

    document.getElementById('lesson-modal').classList.add('open');
    document.body.style.overflow = 'hidden';
  }

  function toggleStep(key, index, el) {
    if (!stepsDone[key]) stepsDone[key] = new Set();
    if (stepsDone[key].has(index)) {
      stepsDone[key].delete(index);
      el.classList.remove('done');
      el.querySelector('.step-number').textContent = index + 1;
    } else {
      stepsDone[key].add(index);
      el.classList.add('done');
      el.querySelector('.step-number').textContent = 'âœ“';
    }
    // Update progress bar in modal
    const total = lessons[key].steps.length;
    const done = stepsDone[key].size;
    const pct = Math.round(done / total * 100);
    const bar = document.querySelector('.modal-body .progress-bar');
    if (bar) bar.style.width = pct + '%';
    const countEl = document.querySelector('.modal-body .progress-bar-wrap');
    if (countEl && countEl.previousElementSibling) {
      countEl.previousElementSibling.querySelector('span:last-child').textContent = `${done}/${total} (${pct}%)`;
    }
  }

  function markComplete() {
    if (!currentLesson) return;
    completedLessons.add(currentLesson);
    document.getElementById(`card-${currentLesson}`).classList.add('completed');
    const btn = document.getElementById('complete-btn');
    btn.textContent = 'âœ… å·²å®Œæˆ Completed';
    btn.style.background = '#6b7280';
    updateOverallProgress();
    setTimeout(() => closeLesson(), 800);
  }

  function updateOverallProgress() {
    const count = completedLessons.size;
    document.getElementById('completed-count').textContent = count;
    document.getElementById('overall-progress').style.width = (count / 6 * 100) + '%';
  }

  function closeLesson() {
    document.getElementById('lesson-modal').classList.remove('open');
    document.body.style.overflow = '';
    currentLesson = null;
  }

  function closeModalOnOverlay(e) {
    if (e.target === document.getElementById('lesson-modal')) closeLesson();
  }

  // ===================== SERVICE WORKER =====================
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('./sw.js')
      .then(() => console.log('âœ… SW registered'))
      .catch(e => console.error('SW error:', e));
  }
</script>
</body>
</html>